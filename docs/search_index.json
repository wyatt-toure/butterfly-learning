[["index.html", "Analysis for ‘Heliconiini butterflies can learn time-dependent reward associations’ Background", " Analysis for ‘Heliconiini butterflies can learn time-dependent reward associations’ M. Wyatt Toure Background This site contains the code, model outputs, and data tables for the analyses in the manuscript ‘Heliconiini butterflies can learn time-dependent reward associations’ The raw data used to conduct these analyses are available in the file heliconiini-data.csv. The raw R code for the H. hecale analysis is located in the file 01-hecale-analysis.Rmd The raw R code for the D. iulia analysis is located in the file 02-dryas-analysis.Rmd. "],["hecale-experiments.html", "Hecale experiments Full model Hecale all participating individuals Hecale high and low performers Hecale activity between time periods", " Hecale experiments Full model In a first pass I looked at a full model, with all butterflies I had data for, which asked whether butterflies shift their preference for the colour that is rewarding in the morning based on the time of day after being trained to either purple or yellow in either the morning or afternoon. I also included random effects of cage and individual ID. Variables cbind(n.morning.colour, n.afternoon.colour) The proportional preference for the colour rewarding in the morning time.of.day The time of day at which a trial was conducted. Either ‘morning’ (8 am to 10 am) or ‘afternoon’ (3pm to 5pm) training The training status of a butterfly. Either ‘trained’ or ‘untrained.’ final.presentation The order of the presentation of the final preference test. Either ‘normal’ (morning test then afternoon test) or ‘reversed’ (afternoon test then morning test) cage The identity of the cage in which the butterfly was trained and tested id The individual identitiy of the butterfly Model full.model = glmer(cbind(n.morning.colour, n.afternoon.colour) ~ time.of.day * training * final.presentation + (1 | cage/id), data = long.heliconiini.data, control=glmerControl(optimizer=&quot;bobyqa&quot;,optCtrl=list(maxfun=2e5)), family = binomial) Factor Estimate Std_Error T_statistic P_value Intercept -1.118 0.413 -2.708 0.007 Time of Day 0.644 0.254 2.532 0.011 Training 1.433 0.197 7.265 &lt; .001 Final Presentation 2.003 0.572 3.502 &lt; .001 Time of Day X Training -0.954 0.291 -3.281 0.001 Time of Day X Final Presentation -0.865 0.287 -3.017 0.003 Training X Final Presentation -1.607 0.224 -7.185 &lt; .001 Time of Day X Training X Final Presentation 0.720 0.331 2.178 0.029 There is a significant three-way interaction effect between the time of day, presentation order of the final test and the training status of butterflies (p = 0.029). Note also that we see more variance among individuals than among cages (individual σ = 1.153, cage σ = 0.202), which suggests individuals are not copying each other. We might have expected individuals to conform to their cage-mates’ choices if butterflies were using social cues leading to more variance among cages than among individuals however we do not see evidence for this. Post-Hoc Tests To investigate the nature of these interactions post-hoc I used emmeans. I was interested in whether training induced a time of day based shift in colour preference. Therefore, I wanted to see if there is a decrease in preference for the colour rewarding in the morning from morning to afternoon after training for both normal and reversed butterflies. If butterflies were only learning the order of presentation we would expect to see an increase in preference for the colour rewarding in the morning from morning to afternoon since these butterflies were presented with their first final test session in the afternoon. To investigate a time-based shift in preference across these treatments I used simple contrasts based on the factor time of day. full.model.emm = emmeans(full.model, ~ training * time.of.day * final.presentation) time.of.day.contrast = contrast(full.model.emm, &quot;consec&quot;, simple = &quot;time.of.day&quot;, combine = TRUE, adjust = &quot;mvt&quot;) %&gt;% summary(infer = TRUE) Results Table 1: Table of post-hoc tests with a multivariate-t adjustment for multiple comparisons of a selected set of means. The contrasts represent the shift in preference for the colour rewarding in the morning based on the time of day, in this case the preference for the colour rewarding in the morning during the afternoon test session is subtracted by the preference for the colour rewarding in the morning during the morning test session. Training represents whether these tests were done prior to training on naive butterflies (untrained) or after training (trained). Values are all rounded to 3 decimal places. contrast training final.presentation estimate asymp.LCL asymp.UCL p.value Afternoon - Morning Untrained normal 0.644 0.146 1.142 0.011 Afternoon - Morning Trained normal -0.310 -0.610 -0.009 0.044 Afternoon - Morning Untrained reversed -0.221 -0.481 0.039 0.095 Afternoon - Morning Trained reversed -0.455 -0.631 -0.279 &lt; .001 Final test presentation order should have no bearing on naive data during the untrained test trial since it is only relevant for the final test trial, nevertheless I present the naive results for both groups when untrained. When untrained, naive butterflies with a normal final test presentation order significantly shift their preference in the incorrect direction by 13.73% (p = 0.011), that is they increase their preference for the colour rewarding in the morning during the afternoon trial. Naive butterflies with a reversed presentation order do not significantly shift their preference (p = 0.095) between time periods when untrained. For both normal and reversed final test presentation order butterflies, there is a decrease in preference for the colour rewarding in the morning from morning to afternoon after training. Butterflies with a standard presentation order decrease their preference for the colour rewarded in the morning by 7.68% (p = 0.043) in the afternoon and butterflies with a reversed final test presentation order decrease their preference for the colour rewarded in the morning by 10.7% (p &lt; 0.001) in the afternoon. Figure 1: Model estimates on the scale of the response variable displaying the interaction effects. Dots represent estimated means and lines connect means across time periods. Naive butterflies either do not shit their preference for the colour rewearded in the morning between time periods (reversed final test order butterflies) or significantly increase their preference for the colour rewarded in the morning in the afternoon (the incorrect direction). Trained butterflies decrease their preference for the colour rewarding in the morning in the afternoon after training in both final presentation order treatments. So in our full model we see there is a lot going on. I wanted to break it down even further. Hecale all participating individuals Across analyses on H. hecale learning performance we asked whether the time of day influenced: In subsections titled Initial preference - the shifts in proportional preference for the colour rewarding in the morning when naïve, using a binomial GLMM with response variable “morning reward colour choices/afternoon reward colour choices” and fixed factor “time of day” (morning or afternoon); In subsections titled Trained preference - shifts in proportional colour preference when trained, using the same specifications but with the additional fixed factor “presentation order” (standard or reversed). Identity was included as a random effect throughout as well as cage if it did not lead to a singular fit due to no variance being captured by the variable. We looked at all individuals—excluding those which did not attempt to feed from both feeders in AM or, more commonly, PM during training (see Hecale activity between time periods section), or did not make any foraging attempts during a final test session. We also established a training criterion given observed variation in responsiveness to the learning task throughout training. We identified individuals that correctly adjusted their behaviour in AM and PM sessions during training with reinforced feeders and in the Hecale high and low performers section asked whether these individuals demonstrate evidence of learning by behaving in the same way when presented with unreinforced feeders in the post-training preference test. Initial preference This model asks whether there is a shift in preference for the colour that is rewarding in the morning between time periods. Variables n.morning.colour.initial is the number of choices made for the colour that is rewarding in the morning n.afternoon.colour.initial is the number of choices made for the colour that is rewarding in the afternoon cage is the identity of the cage the individual was tested and trained in id is the identity of the individual butterfly First we remove any individuals who did not make both colour choices in either morning or afternoon during training. data2 = data %&gt;% group_by(id) %&gt;% filter(all(n.correct.training &gt; 0 &amp; n.incorrect.training &gt; 0)) Then we remove individuals who did not respond at all during a session at the final test. data3 = data2 %&gt;% group_by(id) %&gt;% filter(all(n.morning.colour.test &gt; 0 | n.afternoon.colour.test &gt; 0)) Model We now ask with a binomial GLMM whether there a shift in preference for colours when individuals were naive. naive.model = glmer(cbind(n.morning.colour.initial, n.afternoon.colour.initial) ~ time.of.day + (1 | cage/id), data = data3, family = binomial) Results term estimate std.error statistic p.value (Intercept) -1.156 0.991 -1.167 0.243 time.of.day2afternoon 0.147 0.171 0.860 0.39 We see there is no significant shift in preference for the colour that is rewarding in the morning between time periods initially when individuals are naive (p = 0.39 for time of day effect). Model Residuals Trained preference Variables n.morning.colour.test is the number of choices made for the colour that is rewarding in the morning during the final test n.afternoon.colour.test is the number of choices made for the colour that is rewarding in the afternoon during the final test final.presentation is the order of the final test presentation (morning first or afternoon first) cage is the identity of the cage the individual was tested and trained in id is the identity of the individual butterfly Model Now we will be looking at butterflies after training and asking if there is a shift in preference for the colour that is rewarded in the morning based on the time of day when individuals are trained. We include an effect of final presentation. trained.model = glmer(cbind(n.morning.colour.test, n.afternoon.colour.test) ~ time.of.day * final.presentation + (1 | cage/id), data = data3, family = binomial) Results term estimate std.error statistic p.value (Intercept) 0.444 0.456 0.974 0.33 time.of.day2afternoon -0.291 0.158 -1.846 0.065 final.presentationreversed -0.107 0.632 -0.169 0.865 time.of.day2afternoon:final.presentationreversed 0.270 0.192 1.409 0.159 We don’t find a significant shift as a result of time of day (p = 0.06) but the effect size is in the expected direction i.e., a decrease in the morning reward colour preference in the afternoon. Moreover, we don’t see an effect of final presentation (p = 0.86) or an interaction effect of final presentation with time of day (p = 0.16) Model Residuals Hecale high and low performers We noticed considerable variation in how flexible individuals were during training i.e., some individuals performed better during training compared to others. In order to see whether high performers showed more evidence of learning than low performers, we looked at the initial and trained preferences of butterflies that made a majority (&gt;50%) of correct feeding choices in the final two training days in both the morning and afternoon as well as those that did not meet this criterion. The expectation is that high performers would show evidence of shifting their preference throughout the day at the final test session. Initial preference High Performers First we will be looking at the shift in preference based on time of day initially in naive butterflies that were high performers in the experiment. To do so we will remove individuals who did not achieve greater than 50% correct responses in the last 2 days of training data4 = data3 %&gt;% group_by(id) %&gt;% filter(all(prop.correct.training.last.2 &gt; 0.5)) Model We now ask whether individuals who perform well in last 2 days of training shift colour preference between the time periods initially. naive.model.high.performers = glmer(cbind(n.morning.colour.initial, n.afternoon.colour.initial) ~ time.of.day + (1 | cage/id), data= data4, family = binomial) Results term estimate std.error statistic p.value (Intercept) -0.341 0.770 -0.442 0.658 time.of.day2afternoon 0.064 0.246 0.258 0.796 We find no evidence of high performers shifting their colour preference based on time of day initially (p = 0.79) Model Residuals Low Performers Next we look at individuals which under-performed during training so we extract individuals below the criterion. data5 = data3 %&gt;% group_by(id) %&gt;% filter(any(prop.correct.training.last.2 &lt; 0.51)) Model We now ask do individuals who did not make over 50% correct choices at the last 2 days of training shift their colour preference based on time of day initially? Note we include the line control=glmerControl(optimizer=\"bobyqa\",optCtrl=list(maxfun=2e5)) to change the optimizer since this model initially fails to converge. naive.model.low.performers = glmer(cbind(n.morning.colour.initial, n.afternoon.colour.initial) ~ time.of.day + (1 | id), data =data5, family = binomial, control=glmerControl(optimizer=&quot;bobyqa&quot;,optCtrl=list(maxfun=2e5))) Results term estimate std.error statistic p.value (Intercept) -1.579 0.747 -2.115 0.034 time.of.day2afternoon 0.264 0.237 1.111 0.266 Low performers like high performers do not significantly shift their colour preference based on the time of day between time periods initially (p = 0.26). Model Residuals Trained preference We next look at trained preferences which were measured after 10 days of training. High Performers Model We first ask whether individuals who were correct at a higher rate during training shifted their colour preference based on the time of day when trained. Note here the cage random effect was dropped due to it not capturing any variance leading to a singular fit. trained.model.high.performers = glmer(cbind(n.morning.colour.test, n.afternoon.colour.test) ~ time.of.day * final.presentation + (1 | id), data = data4, family = binomial) Results term estimate std.error statistic p.value (Intercept) 0.575 0.298 1.932 0.053 time.of.day2afternoon -0.435 0.173 -2.507 0.012 final.presentationreversed -0.152 0.395 -0.383 0.701 time.of.day2afternoon:final.presentationreversed 0.148 0.248 0.598 0.55 We find that there is a significant shift in preference for the morning colour between time periods among high performing butterflies (p = 0.01). When trained these butterflies shift their preference for the morning reward colour by 12% (Figure 2). Figure 2: Data from colour preference trials of H. hecale meeting the training criterion. (A) Naïve preferences in the morning and afternoon. (B) Preferences of butterflies from (A) post-training. Grey lines connect individuals. Data are means ± 95% CI. Model Residuals Low Performers We now ask whether individuals who were not correct at a high rate shift preference when trained. Model trained.model.low.performers = glmer(cbind(n.morning.colour.test, n.afternoon.colour.test) ~ time.of.day * final.presentation + (1 | cage/id), data= data5, family = binomial) Results term estimate std.error statistic p.value (Intercept) 0.104 0.988 0.105 0.916 time.of.day2afternoon 0.460 0.391 1.176 0.24 final.presentationreversed 0.406 1.287 0.315 0.753 time.of.day2afternoon:final.presentationreversed -0.317 0.415 -0.764 0.445 No significant shift in preference among low performers. Model Residuals Hecale activity between time periods To see whether there was a difference in the total number of choices a butterfly made at a particular time period we used a Poisson generalised linear mixed effect model. Variables total.activity is the total number of choices (correct and incorrect) a butterfly made in a time period time.of.day is the time period of the trial (morning or afternoon) cage is the identity of the cage the individual was tested and trained in id is the identity of the individual butterfly Model activity.model = glmer(total.activity ~ time.of.day + (1 | cage/id), data= data, family = poisson) Results term estimate std.error statistic p.value (Intercept) 4.270 0.102 41.887 &lt; .001 time.of.day2afternoon -0.346 0.026 -13.082 &lt; .001 On average butterflies make 24 less choices in the afternoon. Figure 3: The morning and afternoon activity values for individuual btuterflies. Data are means +/- 95% CI. Lines connects individuals across time periods Model Residuals "],["dryas-experiments.html", "Dryas experiments Dryas all participating individuals Trained preference Dryas high and low performers Dryas activity between time periods", " Dryas experiments In a second experiment, we tested a reduced sample of Dryas iulia, a closely related butterfly, to test if the ability to learn associations was limited to Heliconius. 13 out of 19 D. iulia made both choices in both time periods during training, the remaining 6 were removed from further analyses. An additional individual was removed after making no feeding attempts in the final test. One cage had purple rewarded in the AM and yellow rewarded in the PM with an unreversed final test order (group 1), while the second cage had yellow rewarded in the AM and purple rewarded in the PM with a reversed final test order (group 2). In this sample only Dryas from group 2 met the training criterion (n = 6). However, since the order of the final test has no bearing on how an individual behaves during the training trials, and test order has no effect in H. hecale, we assumed this is unlikely to be problematic. Dryas all participating individuals Across analyses on Dryas learning performance we again asked whether the time of day influenced: In subsections titled Initial preference - shifts in proportional preference for the colour rewarding in the morning when naïve, using a binomial GLMM with response variable “morning reward colour choices/afternoon reward colour choices” and fixed factor “time of day” (morning or afternoon); In subsections titled Trained preference - shifts in proportional colour preference when trained, using the same specifications. Identity was included as a random effect throughout. First we subset our data to remove any individuals who did not make both colour choices in either morning or afternoon during training. data2 = data %&gt;% group_by(id) %&gt;% filter(all(n.correct.training &gt; 0 &amp; n.incorrect.training &gt; 0)) Furthermore we remove individuals who did not respond at all during a session in final test. data3 = data2 %&gt;% group_by(id) %&gt;% filter(all(n.morning.colour.test &gt; 0 | n.afternoon.colour.test &gt; 0)) Initial preference Model We first ask whether there is there a shift in preference for colours based on the time of day when individuals are naive. naive.model = glmer(cbind(n.morning.colour.initial, n.afternoon.colour.initial) ~ time.of.day + (1 | cage/id), data= data3, family = binomial) Results term estimate std.error statistic p.value (Intercept) 0.511 0.696 0.734 0.463 time.of.day2afternoon 0.367 0.233 1.574 0.116 No, p-value = 0.11 for time of day effect Model Residuals Trained preference Model In this model we ask whether there is a shift in colour preference based on time of day for all butterflies which participated in the experiment. trained.model = glmer(cbind(n.morning.colour.test, n.afternoon.colour.test) ~ time.of.day + (1 | id), data= data3, family = binomial) Results term estimate std.error statistic p.value (Intercept) 0.383 0.293 1.308 0.191 time.of.day2afternoon 0.001 0.102 0.012 0.991 No, p = 0.99 for time of day effect Model Residuals Dryas high and low performers Remove individuals who did not achieve greater than 50% correct responses in last 2 days of training data4 = data3 %&gt;% group_by(id) %&gt;% filter(all(prop.correct.training.last.2 &gt; 0.5)) Initial preference High Performers Model Do individuals who perform well in last 2 days of training shift preference initially naive.model.high.performers = glmer(cbind(n.morning.colour.initial, n.afternoon.colour.initial) ~ time.of.day + (1 |id), data= data4, family = binomial) Results term estimate std.error statistic p.value (Intercept) -0.546 0.466 -1.172 0.241 time.of.day2afternoon 0.536 0.321 1.670 0.095 No, p = 0.09 Model Residuals # pull out individuals below criterion data5 = data3 %&gt;% group_by(id) %&gt;% filter(any(prop.correct.training.last.2 &lt; 0.51)) Model In this model we ask whether lower performing individuals shift their colour preference based on the time of day prior to training. naive.model.low.performers = glmer(cbind(n.morning.colour.initial, n.afternoon.colour.initial) ~ time.of.day + (1 | id), data =data5, family = binomial) Results term estimate std.error statistic p.value (Intercept) 1.333 0.496 2.687 0.007 time.of.day2afternoon 0.148 0.339 0.437 0.662 No, p = 0.66 Model Residuals Trained preference High Performers Model In this model we ask whether higher performing individuals shift their colour preference based on the time of day after training. trained.model.high.performers = glmer(cbind(n.morning.colour.test, n.afternoon.colour.test) ~ time.of.day + (1 | id), data= data4, family = binomial) Results term estimate std.error statistic p.value (Intercept) 1.435 0.398 3.604 &lt; .001 time.of.day2afternoon -1.819 0.195 -9.334 &lt; .001 We find a significant effect of time of day (p &lt; 0.001). In high performing D. iulia, the preference for the colour that is rewarding in the morning decreased by 40%. Figure 4: Data from colour preference trials of D. iulia meeting the training criterion. (A) Naïve preferences in the morning and afternoon. (B) Preferences of butterflies from (A) post-training. Grey lines connect individuals. Data are means ± 95% CI Model Residuals There’s a slight deviation due to the outlier which increases the variance in the trained afternoon session as seen in Figure 4 Model In this model we ask whether lower performers shift their colour preference based on the time of day. trained.model.low.performers = glmer(cbind(n.morning.colour.test, n.afternoon.colour.test) ~ time.of.day + (1 | id), data= data5, family = binomial) Results term estimate std.error statistic p.value (Intercept) 0.063 0.489 0.129 0.898 time.of.day2afternoon 0.992 0.135 7.354 &lt; .001 There is a significant effect of time of day for lower performers (p &lt; 0.001). Low performers shift their preference in the incorrect direction by about 12% (Figure 5). Figure 5: Data from colour preference trials of D. iulia that do not meet the training criterion. (A) Naïve preferences in the morning and afternoon. (B) Preferences of butterflies from (A) post-training. Grey lines connect individuals. Data are means ± 95% CI Model Residuals Dryas activity between time periods Model To see whether there was a difference in the total number of choices a butterfly made at a particular time period we used a Poisson generalised linear mixed effect model. dryas.activity.model = glmer(total.activity ~ time.of.day + (1 | cage/id), data= data, family = poisson) Results D. iulia butterflies made on average 15 more choices in the afternoon than in the morning. Figure 6: The morning and afternoon activity values for individuual btuterflies. Data are means +/- 95% CI. Lines connects individuals across time periods Model Residuals "],["tools-used-and-references.html", "Tools used and References", " Tools used and References A complete list of the tools used is produced below: Package Version Reference broom 0.5.5 David Robinson and Alex Hayes (2020). broom: Convert Statistical Analysis Objects into Tidy Tibbles. R package version 0.5.5. https://CRAN.R-project.org/package=broom broom.mixed 0.2.6 Ben Bolker and David Robinson (2020). broom.mixed: Tidying Methods for Mixed Models. R package version 0.2.6. https://CRAN.R-project.org/package=broom.mixed carData 3.0.3 John Fox, Sanford Weisberg and Brad Price (2019). carData: Companion to Applied Regression Data Sets. R package version 3.0-3. https://CRAN.R-project.org/package=carData cowplot 1.0.0 Claus O. Wilke (2019). cowplot: Streamlined Plot Theme and Plot Annotations for ‘ggplot2.’ R package version 1.0.0. https://CRAN.R-project.org/package=cowplot DHARMa 0.3.3.0 Florian Hartig (2020). DHARMa: Residual Diagnostics for Hierarchical (Multi-Level / Mixed) Regression Models. R package version 0.3.3.0. http://florianhartig.github.io/DHARMa/ dplyr 1.0.3 Hadley Wickham, Romain François, Lionel Henry and Kirill Müller (2021). dplyr: A Grammar of Data Manipulation. R package version 1.0.3. https://CRAN.R-project.org/package=dplyr effects 4.1.4 John Fox and Sanford Weisberg (2019). An R Companion to Applied Regression, 3rd Edition. Thousand Oaks, CA http://tinyurl.com/carbook emmeans 1.5.1 Russell Lenth (2020). emmeans: Estimated Marginal Means, aka Least-Squares Means. R package version 1.5.1. https://CRAN.R-project.org/package=emmeans ggplot2 3.3.3 H. Wickham. ggplot2: Elegant Graphics for Data Analysis. Springer-Verlag New York, 2016. ggpubr 0.2.5 Alboukadel Kassambara (2020). ggpubr: ‘ggplot2’ Based Publication Ready Plots. R package version 0.2.5. https://CRAN.R-project.org/package=ggpubr lme4 1.1.21 Douglas Bates, Martin Maechler, Ben Bolker, Steve Walker (2015). Fitting Linear Mixed-Effects Models Using lme4. Journal of Statistical Software, 67(1), 1-48. doi:10.18637/jss.v067.i01. lmerTest 3.1.1 Kuznetsova A, Brockhoff PB, Christensen RHB (2017). “lmerTest Package:Tests in Linear Mixed Effects Models.” Journal of StatisticalSoftware, 82(13), 1-26. doi: 10.18637/jss.v082.i13 (URL:https://doi.org/10.18637/jss.v082.i13). magrittr 2.0.1 Stefan Milton Bache and Hadley Wickham (2020). magrittr: A Forward-Pipe Operator for R. R package version 2.0.1. https://CRAN.R-project.org/package=magrittr Matrix 1.2.18 Douglas Bates and Martin Maechler (2019). Matrix: Sparse and Dense Matrix Classes and Methods. R package version 1.2-18. https://CRAN.R-project.org/package=Matrix psych 1.9.12.31 Revelle, W. (2019) psych: Procedures for Personality and Psychological Research, Northwestern University, Evanston, Illinois, USA, https://CRAN.R-project.org/package=psych Version = 1.9.12. R 3.6.2 R Core Team (2019). R: A language and environment for statistical computing. R Foundation for Statistical Computing, Vienna, Austria. URL https://www.R-project.org/. report 0.2.0 Makowski, D., Lüdecke, D., &amp; Ben-Shachar, M.S. (2020). Automated reporting as a practical tool to improve reproducibility and methodological best practices adoption. CRAN. Available from https://github.com/easystats/report. doi: . tidyr 1.0.2 Hadley Wickham and Lionel Henry (2020). tidyr: Tidy Messy Data. R package version 1.0.2. https://CRAN.R-project.org/package=tidyr "]]
