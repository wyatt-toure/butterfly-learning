<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Hecale experiments | Analysis for ‘Heliconiini butterflies can learn time-dependent reward associations’</title>
  <meta name="description" content="Hecale experiments | Analysis for ‘Heliconiini butterflies can learn time-dependent reward associations’" />
  <meta name="generator" content="bookdown 0.21 and GitBook 2.6.7" />

  <meta property="og:title" content="Hecale experiments | Analysis for ‘Heliconiini butterflies can learn time-dependent reward associations’" />
  <meta property="og:type" content="book" />
  
  
  
  

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Hecale experiments | Analysis for ‘Heliconiini butterflies can learn time-dependent reward associations’" />
  
  
  

<meta name="author" content="Wyatt Toure" />



  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="index.html"/>
<link rel="next" href="dryas-experiments.html"/>
<script src="libs/header-attrs-2.6.4/header-attrs.js"></script>
<script src="libs/jquery-2.2.3/jquery.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />











<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">Heliconiini learning analysis</a></li>

<li class="divider"></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>Background</a></li>
<li class="chapter" data-level="" data-path="hecale-experiments.html"><a href="hecale-experiments.html"><i class="fa fa-check"></i>Hecale experiments</a>
<ul>
<li class="chapter" data-level="" data-path="hecale-experiments.html"><a href="hecale-experiments.html#hecale-all-individuals"><i class="fa fa-check"></i>Hecale, all individuals</a>
<ul>
<li class="chapter" data-level="" data-path="hecale-experiments.html"><a href="hecale-experiments.html#initial-preference"><i class="fa fa-check"></i>Initial preference</a></li>
<li class="chapter" data-level="" data-path="hecale-experiments.html"><a href="hecale-experiments.html#trained-preference"><i class="fa fa-check"></i>Trained preference</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="hecale-experiments.html"><a href="hecale-experiments.html#hecale-high-and-low-performers"><i class="fa fa-check"></i>Hecale high and low performers</a>
<ul>
<li class="chapter" data-level="" data-path="hecale-experiments.html"><a href="hecale-experiments.html#initial-preference-1"><i class="fa fa-check"></i>Initial preference</a></li>
<li class="chapter" data-level="" data-path="hecale-experiments.html"><a href="hecale-experiments.html#trained-preference-1"><i class="fa fa-check"></i>Trained preference</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="hecale-experiments.html"><a href="hecale-experiments.html#hecale-activity-between-time-periods"><i class="fa fa-check"></i>Hecale activity between time periods</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="dryas-experiments.html"><a href="dryas-experiments.html"><i class="fa fa-check"></i>Dryas experiments</a>
<ul>
<li class="chapter" data-level="" data-path="dryas-experiments.html"><a href="dryas-experiments.html#dryas-all-individuals"><i class="fa fa-check"></i>Dryas all individuals</a>
<ul>
<li class="chapter" data-level="" data-path="dryas-experiments.html"><a href="dryas-experiments.html#initial-preference-2"><i class="fa fa-check"></i>Initial preference</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="dryas-experiments.html"><a href="dryas-experiments.html#trained-preference-2"><i class="fa fa-check"></i>Trained preference</a></li>
<li class="chapter" data-level="" data-path="dryas-experiments.html"><a href="dryas-experiments.html#dryas-high-and-low-performers"><i class="fa fa-check"></i>Dryas high and low performers</a>
<ul>
<li class="chapter" data-level="" data-path="dryas-experiments.html"><a href="dryas-experiments.html#initial-preference-3"><i class="fa fa-check"></i>Initial preference</a></li>
<li class="chapter" data-level="" data-path="dryas-experiments.html"><a href="dryas-experiments.html#trained-preference-3"><i class="fa fa-check"></i>Trained preference</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="dryas-experiments.html"><a href="dryas-experiments.html#dryas-activity-between-time-periods"><i class="fa fa-check"></i>Dryas activity between time periods</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="tools-used-and-references.html"><a href="tools-used-and-references.html"><i class="fa fa-check"></i>Tools used and References</a></li>
</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Analysis for ‘Heliconiini butterflies can learn time-dependent reward associations’</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="hecale-experiments" class="section level1">
<h1>Hecale experiments</h1>
<p>Across analyses on learning performance we asked whether the time of day influenced:</p>
<ol style="list-style-type: lower-alpha">
<li><p>in subsections titled <strong>Initial preference</strong>, shifts in proportional preference for the colour rewarding in the morning when naïve, using a binomial GLMM with response variable “morning reward colour choices/afternoon reward colour choices” and fixed factor “time of day” (morning or afternoon);</p></li>
<li><p>in subsections titled <strong>Trained preference</strong>, shifts in proportional colour preference when trained, using the same specifications but with the additional fixed factor “presentation order” (standard or reversed).</p></li>
</ol>
<p>Identity was included as a random effect throughout as well as cage if it did not lead to a singular fit due to no variance being captured by the variable.</p>
<div id="hecale-all-individuals" class="section level2">
<h2>Hecale, all individuals</h2>
<p>We initially looked at all individuals—excluding those which did not attempt to feed from both feeders in AM or, more commonly, PM during training (see Hecale activity between time periods section), or did not make any foraging attempts during a final test session. We also established a training criterion given variation in responsiveness to the test during training we identified individuals that correctly adjust their behaviour in AM and PM sessions during training with reinforced feeders. In the Hecale high and low performers section we asked whether these individuals demonstrate evidence of learning by behaving in the same way when presented with unreinforced feeders in the post-training preference test.</p>
<div id="initial-preference" class="section level3">
<h3>Initial preference</h3>
<p>This model asks whether there is a shift in preference for the colour that is rewarding in the morning between time periods.</p>
<div id="variables" class="section level5">
<h5>Variables</h5>
<ul>
<li><code>n.morning.colour.initial</code> is the number of choices made for the colour that is rewarding in the morning</li>
<li><code>n.afternoon.colour.initial</code> is the number of choices made for the colour that is rewarding in the afternoon</li>
<li><code>cage</code> is the identity of the cage the individual was tested and trained in</li>
<li><code>id</code> is the identity of the individual butterfly</li>
</ul>
<p>First we remove any individuals who did not make both colour choices in either morning or afternoon during training.</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1-1"><a href="hecale-experiments.html#cb1-1" aria-hidden="true" tabindex="-1"></a>data2 <span class="ot">=</span> data <span class="sc">%&gt;%</span> </span>
<span id="cb1-2"><a href="hecale-experiments.html#cb1-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(id) <span class="sc">%&gt;%</span> </span>
<span id="cb1-3"><a href="hecale-experiments.html#cb1-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="fu">all</span>(n.correct.training <span class="sc">&gt;</span> <span class="dv">0</span> <span class="sc">&amp;</span> n.incorrect.training <span class="sc">&gt;</span> <span class="dv">0</span>))</span></code></pre></div>
<p>Then we remove individuals who did not respond at all during a session at the final test.</p>
<div class="sourceCode" id="cb2"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2-1"><a href="hecale-experiments.html#cb2-1" aria-hidden="true" tabindex="-1"></a>data3 <span class="ot">=</span> data2 <span class="sc">%&gt;%</span> </span>
<span id="cb2-2"><a href="hecale-experiments.html#cb2-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(id) <span class="sc">%&gt;%</span> </span>
<span id="cb2-3"><a href="hecale-experiments.html#cb2-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="fu">all</span>(n.morning.colour.test <span class="sc">&gt;</span> <span class="dv">0</span> <span class="sc">|</span> n.afternoon.colour.test <span class="sc">&gt;</span> <span class="dv">0</span>))</span></code></pre></div>
<p>Is there a shift in preference for colours when individuals are naive ?</p>
</div>
<div id="model" class="section level5">
<h5>Model</h5>
<div class="sourceCode" id="cb3"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb3-1"><a href="hecale-experiments.html#cb3-1" aria-hidden="true" tabindex="-1"></a>naive.model <span class="ot">=</span> </span>
<span id="cb3-2"><a href="hecale-experiments.html#cb3-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">glmer</span>(<span class="fu">cbind</span>(n.morning.colour.initial, n.afternoon.colour.initial) <span class="sc">~</span> </span>
<span id="cb3-3"><a href="hecale-experiments.html#cb3-3" aria-hidden="true" tabindex="-1"></a>          time.of.day <span class="sc">+</span> (<span class="dv">1</span> <span class="sc">|</span> cage<span class="sc">/</span>id),</span>
<span id="cb3-4"><a href="hecale-experiments.html#cb3-4" aria-hidden="true" tabindex="-1"></a>        <span class="at">data =</span> data3, <span class="at">family =</span> binomial)</span></code></pre></div>
</div>
<div id="results" class="section level5">
<h5>Results</h5>
<table>
<thead>
<tr class="header">
<th align="left">term</th>
<th align="right">estimate</th>
<th align="right">std.error</th>
<th align="right">statistic</th>
<th align="left">p.value</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">(Intercept)</td>
<td align="right">-1.156</td>
<td align="right">0.991</td>
<td align="right">-1.167</td>
<td align="left">0.243</td>
</tr>
<tr class="even">
<td align="left">time.of.day2afternoon</td>
<td align="right">0.147</td>
<td align="right">0.171</td>
<td align="right">0.860</td>
<td align="left">0.39</td>
</tr>
</tbody>
</table>
<p>No, there is no significant shift in preference for the colour that is rewarding in the morning between time periods initially when individuals are naive.</p>
</div>
<div id="model-residuals" class="section level5">
<h5>Model Residuals</h5>
<p><img src="Analysis-for-Heliconiini-time-learning_files/figure-html/unnamed-chunk-6-1.png" width="672" /></p>
</div>
</div>
<div id="trained-preference" class="section level3">
<h3>Trained preference</h3>
<div id="variables-1" class="section level5">
<h5>Variables</h5>
<ul>
<li><code>n.morning.colour.test</code> is the number of choices made for the colour that is rewarding in the morning during the final test</li>
<li><code>n.afternoon.colour.test</code> is the number of choices made for the colour that is rewarding in the afternoon during the final test</li>
<li><code>final.presentation</code> is the order of the final test presentation (morning first or afternoon first)</li>
<li><code>cage</code> is the identity of the cage the individual was tested and trained in</li>
<li><code>id</code> is the identity of the individual butterfly</li>
</ul>
</div>
<div id="model-1" class="section level5">
<h5>Model</h5>
<p>Is there a shift in preference for colours when individuals are trained</p>
<div class="sourceCode" id="cb4"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb4-1"><a href="hecale-experiments.html#cb4-1" aria-hidden="true" tabindex="-1"></a>trained.model <span class="ot">=</span> </span>
<span id="cb4-2"><a href="hecale-experiments.html#cb4-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">glmer</span>(<span class="fu">cbind</span>(n.morning.colour.test, n.afternoon.colour.test) <span class="sc">~</span> </span>
<span id="cb4-3"><a href="hecale-experiments.html#cb4-3" aria-hidden="true" tabindex="-1"></a>          time.of.day <span class="sc">*</span> final.presentation <span class="sc">+</span> (<span class="dv">1</span> <span class="sc">|</span> cage<span class="sc">/</span>id), </span>
<span id="cb4-4"><a href="hecale-experiments.html#cb4-4" aria-hidden="true" tabindex="-1"></a>        <span class="at">data =</span> data3, <span class="at">family =</span> binomial)</span></code></pre></div>
</div>
<div id="results-1" class="section level5">
<h5>Results</h5>
<table>
<thead>
<tr class="header">
<th align="left">term</th>
<th align="right">estimate</th>
<th align="right">std.error</th>
<th align="right">statistic</th>
<th align="left">p.value</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">(Intercept)</td>
<td align="right">0.444</td>
<td align="right">0.456</td>
<td align="right">0.974</td>
<td align="left">0.33</td>
</tr>
<tr class="even">
<td align="left">time.of.day2afternoon</td>
<td align="right">-0.291</td>
<td align="right">0.158</td>
<td align="right">-1.846</td>
<td align="left">0.065</td>
</tr>
<tr class="odd">
<td align="left">final.presentationreversed</td>
<td align="right">-0.107</td>
<td align="right">0.632</td>
<td align="right">-0.169</td>
<td align="left">0.865</td>
</tr>
<tr class="even">
<td align="left">time.of.day2afternoon:final.presentationreversed</td>
<td align="right">0.270</td>
<td align="right">0.192</td>
<td align="right">1.409</td>
<td align="left">0.159</td>
</tr>
</tbody>
</table>
<p>We don’t find a significant shift as a result of time of day (p = 0.06) but the effect size is in the expected direction <em>i.e.</em> a decrease in the morning reward colour preference in the afternoon.</p>
</div>
<div id="model-residuals-1" class="section level5">
<h5>Model Residuals</h5>
<p><img src="Analysis-for-Heliconiini-time-learning_files/figure-html/unnamed-chunk-11-1.png" width="672" /></p>
</div>
</div>
</div>
<div id="hecale-high-and-low-performers" class="section level2">
<h2>Hecale high and low performers</h2>
<p>We noticed considerable variation in how flexible individuals were during training <em>i.e.</em>, some individuals performed better during training compared to others. In order to see whether high performers showed more evidence of learning than low performers we looked at the initial and trained preferences of butterflies that made a majority (&gt;50%) of correct feeding choices in the final two training days in both the morning and afternoon as well as those that did not meet this criterion. The expectation is that high performers would show more evidence of shifting their preference throughout the day at the final test session.</p>
<div id="initial-preference-1" class="section level3">
<h3>Initial preference</h3>
<div id="high-performers" class="section level4">
<h4>High Performers</h4>
<p>First we will be looking at the shift in preference initially in naive butterflies that were high performers in the experiment. To do so we will remove individuals who did not achieve greater than 50% correct responses in the last 2 days of training</p>
<div class="sourceCode" id="cb5"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb5-1"><a href="hecale-experiments.html#cb5-1" aria-hidden="true" tabindex="-1"></a>data4 <span class="ot">=</span> data3 <span class="sc">%&gt;%</span> <span class="fu">group_by</span>(id) <span class="sc">%&gt;%</span> <span class="fu">filter</span>(<span class="fu">all</span>(prop.correct.training.last<span class="fl">.2</span> <span class="sc">&gt;</span> <span class="fl">0.5</span>))</span></code></pre></div>
<p>We ask whether individuals who perform well in last 2 days of training shift preference between the time periods initially.</p>
<div id="model-2" class="section level5">
<h5>Model</h5>
<div class="sourceCode" id="cb6"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb6-1"><a href="hecale-experiments.html#cb6-1" aria-hidden="true" tabindex="-1"></a>naive.model.high.performers <span class="ot">=</span> </span>
<span id="cb6-2"><a href="hecale-experiments.html#cb6-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">glmer</span>(<span class="fu">cbind</span>(n.morning.colour.initial, n.afternoon.colour.initial) <span class="sc">~</span> </span>
<span id="cb6-3"><a href="hecale-experiments.html#cb6-3" aria-hidden="true" tabindex="-1"></a>                                      time.of.day  <span class="sc">+</span> (<span class="dv">1</span> <span class="sc">|</span> cage<span class="sc">/</span>id),</span>
<span id="cb6-4"><a href="hecale-experiments.html#cb6-4" aria-hidden="true" tabindex="-1"></a>                                    <span class="at">data=</span> data4, <span class="at">family =</span> binomial)</span></code></pre></div>
</div>
<div id="results-2" class="section level5">
<h5>Results</h5>
<table>
<thead>
<tr class="header">
<th align="left">term</th>
<th align="right">estimate</th>
<th align="right">std.error</th>
<th align="right">statistic</th>
<th align="left">p.value</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">(Intercept)</td>
<td align="right">-0.341</td>
<td align="right">0.770</td>
<td align="right">-0.442</td>
<td align="left">0.658</td>
</tr>
<tr class="even">
<td align="left">time.of.day2afternoon</td>
<td align="right">0.064</td>
<td align="right">0.246</td>
<td align="right">0.258</td>
<td align="left">0.796</td>
</tr>
</tbody>
</table>
<p>High performers do not significantly shift preference initially.</p>
</div>
<div id="model-residuals-2" class="section level5">
<h5>Model Residuals</h5>
<p><img src="Analysis-for-Heliconiini-time-learning_files/figure-html/unnamed-chunk-16-1.png" width="672" /></p>
</div>
</div>
<div id="low-performers" class="section level4">
<h4>Low Performers</h4>
<p>Next we will look at individuals which under-performed during training so we extract individuals below the criterion.</p>
<div class="sourceCode" id="cb7"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb7-1"><a href="hecale-experiments.html#cb7-1" aria-hidden="true" tabindex="-1"></a>data5 <span class="ot">=</span> data3 <span class="sc">%&gt;%</span> <span class="fu">group_by</span>(id) <span class="sc">%&gt;%</span> <span class="fu">filter</span>(<span class="fu">any</span>(prop.correct.training.last<span class="fl">.2</span> <span class="sc">&lt;</span> <span class="fl">0.51</span>))</span></code></pre></div>
<p>We now ask do individuals who were incorrect at high rate shift preference initially? Note we include the line <code>control=glmerControl(optimizer="bobyqa",optCtrl=list(maxfun=2e5))</code> to change the optimizer since this model initially fails to converge.</p>
<div id="model-3" class="section level5">
<h5>Model</h5>
<div class="sourceCode" id="cb8"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb8-1"><a href="hecale-experiments.html#cb8-1" aria-hidden="true" tabindex="-1"></a>naive.model.low.performers <span class="ot">=</span> </span>
<span id="cb8-2"><a href="hecale-experiments.html#cb8-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">glmer</span>(<span class="fu">cbind</span>(n.morning.colour.initial, n.afternoon.colour.initial) <span class="sc">~</span> </span>
<span id="cb8-3"><a href="hecale-experiments.html#cb8-3" aria-hidden="true" tabindex="-1"></a>          time.of.day <span class="sc">+</span> (<span class="dv">1</span> <span class="sc">|</span> id), <span class="at">data =</span>data5, </span>
<span id="cb8-4"><a href="hecale-experiments.html#cb8-4" aria-hidden="true" tabindex="-1"></a>        <span class="at">family =</span> binomial, </span>
<span id="cb8-5"><a href="hecale-experiments.html#cb8-5" aria-hidden="true" tabindex="-1"></a>        <span class="at">control=</span><span class="fu">glmerControl</span>(<span class="at">optimizer=</span><span class="st">&quot;bobyqa&quot;</span>,<span class="at">optCtrl=</span><span class="fu">list</span>(<span class="at">maxfun=</span><span class="fl">2e5</span>)))</span></code></pre></div>
</div>
<div id="results-3" class="section level5">
<h5>Results</h5>
<table>
<thead>
<tr class="header">
<th align="left">term</th>
<th align="right">estimate</th>
<th align="right">std.error</th>
<th align="right">statistic</th>
<th align="left">p.value</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">(Intercept)</td>
<td align="right">-1.579</td>
<td align="right">0.747</td>
<td align="right">-2.115</td>
<td align="left">0.034</td>
</tr>
<tr class="even">
<td align="left">time.of.day2afternoon</td>
<td align="right">0.264</td>
<td align="right">0.237</td>
<td align="right">1.111</td>
<td align="left">0.266</td>
</tr>
</tbody>
</table>
<p>Low performers also do not significantly shift their preference between time periods initially.</p>
</div>
<div id="model-residuals-3" class="section level5">
<h5>Model Residuals</h5>
<p><img src="Analysis-for-Heliconiini-time-learning_files/figure-html/unnamed-chunk-21-1.png" width="672" /></p>
</div>
</div>
</div>
<div id="trained-preference-1" class="section level3">
<h3>Trained preference</h3>
<p>Now we will look at trained preferences which were measured after 10 days of training.</p>
<div id="high-performers-1" class="section level4">
<h4>High Performers</h4>
<p>We first ask whether individuals who were correct at a high rate during training shift preference when trained. Note here the cage random effect was dropped due to it not capturing any variance leading to a singular fit.</p>
<div id="model-4" class="section level5">
<h5>Model</h5>
<div class="sourceCode" id="cb9"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb9-1"><a href="hecale-experiments.html#cb9-1" aria-hidden="true" tabindex="-1"></a>trained.model.high.performers <span class="ot">=</span> </span>
<span id="cb9-2"><a href="hecale-experiments.html#cb9-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">glmer</span>(<span class="fu">cbind</span>(n.morning.colour.test, n.afternoon.colour.test) <span class="sc">~</span> </span>
<span id="cb9-3"><a href="hecale-experiments.html#cb9-3" aria-hidden="true" tabindex="-1"></a>          time.of.day <span class="sc">*</span> final.presentation <span class="sc">+</span> (<span class="dv">1</span> <span class="sc">|</span> id), </span>
<span id="cb9-4"><a href="hecale-experiments.html#cb9-4" aria-hidden="true" tabindex="-1"></a>        <span class="at">data=</span>  data4, <span class="at">family =</span> binomial)</span></code></pre></div>
</div>
<div id="results-4" class="section level5">
<h5>Results</h5>
<table>
<thead>
<tr class="header">
<th align="left">term</th>
<th align="right">estimate</th>
<th align="right">std.error</th>
<th align="right">statistic</th>
<th align="left">p.value</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">(Intercept)</td>
<td align="right">0.575</td>
<td align="right">0.298</td>
<td align="right">1.932</td>
<td align="left">0.053</td>
</tr>
<tr class="even">
<td align="left">time.of.day2afternoon</td>
<td align="right">-0.435</td>
<td align="right">0.173</td>
<td align="right">-2.507</td>
<td align="left">0.012</td>
</tr>
<tr class="odd">
<td align="left">final.presentationreversed</td>
<td align="right">-0.152</td>
<td align="right">0.395</td>
<td align="right">-0.383</td>
<td align="left">0.701</td>
</tr>
<tr class="even">
<td align="left">time.of.day2afternoon:final.presentationreversed</td>
<td align="right">0.148</td>
<td align="right">0.248</td>
<td align="right">0.598</td>
<td align="left">0.55</td>
</tr>
</tbody>
</table>
<p>We find that there is a significant shift in preference for the morning colour between time periods among high performing butterflies. When trained these butterflies shift their preference for the morning reward colour by 12% (Figure <a href="hecale-experiments.html#fig:learning-data-plot">1</a>).</p>
<div class="figure"><span id="fig:learning-data-plot"></span>
<img src="Analysis-for-Heliconiini-time-learning_files/figure-html/learning-data-plot-1.png" alt="Data from colour preference trials of H. hecale meeting the training criterion. (A) Naïve preferences in the morning and afternoon. (B) Preferences of butterflies from (A) post-training. Grey lines connect individuals. Data are means ± 95% CI." width="672" />
<p class="caption">
Figure 1: Data from colour preference trials of H. hecale meeting the training criterion. (A) Naïve preferences in the morning and afternoon. (B) Preferences of butterflies from (A) post-training. Grey lines connect individuals. Data are means ± 95% CI.
</p>
</div>
</div>
<div id="model-residuals-4" class="section level5">
<h5>Model Residuals</h5>
<p><img src="Analysis-for-Heliconiini-time-learning_files/figure-html/unnamed-chunk-25-1.png" width="672" /></p>
</div>
</div>
<div id="low-performers-1" class="section level4">
<h4>Low Performers</h4>
<p>We now ask whether individuals who were not correct at a high rate shift preference when trained.</p>
<div id="model-5" class="section level5">
<h5>Model</h5>
<div class="sourceCode" id="cb10"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb10-1"><a href="hecale-experiments.html#cb10-1" aria-hidden="true" tabindex="-1"></a>trained.model.low.performers <span class="ot">=</span> </span>
<span id="cb10-2"><a href="hecale-experiments.html#cb10-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">glmer</span>(<span class="fu">cbind</span>(n.morning.colour.test, n.afternoon.colour.test) <span class="sc">~</span> </span>
<span id="cb10-3"><a href="hecale-experiments.html#cb10-3" aria-hidden="true" tabindex="-1"></a>          time.of.day <span class="sc">*</span> final.presentation <span class="sc">+</span> (<span class="dv">1</span> <span class="sc">|</span> cage<span class="sc">/</span>id), </span>
<span id="cb10-4"><a href="hecale-experiments.html#cb10-4" aria-hidden="true" tabindex="-1"></a>        <span class="at">data=</span>  data5, <span class="at">family =</span> binomial)</span></code></pre></div>
</div>
<div id="results-5" class="section level5">
<h5>Results</h5>
<table>
<thead>
<tr class="header">
<th align="left">term</th>
<th align="right">estimate</th>
<th align="right">std.error</th>
<th align="right">statistic</th>
<th align="left">p.value</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">(Intercept)</td>
<td align="right">0.104</td>
<td align="right">0.988</td>
<td align="right">0.105</td>
<td align="left">0.916</td>
</tr>
<tr class="even">
<td align="left">time.of.day2afternoon</td>
<td align="right">0.460</td>
<td align="right">0.391</td>
<td align="right">1.176</td>
<td align="left">0.24</td>
</tr>
<tr class="odd">
<td align="left">final.presentationreversed</td>
<td align="right">0.406</td>
<td align="right">1.287</td>
<td align="right">0.315</td>
<td align="left">0.753</td>
</tr>
<tr class="even">
<td align="left">time.of.day2afternoon:final.presentationreversed</td>
<td align="right">-0.317</td>
<td align="right">0.415</td>
<td align="right">-0.764</td>
<td align="left">0.445</td>
</tr>
</tbody>
</table>
<p>No significant shift in preference among low performers.</p>
</div>
<div id="model-residuals-5" class="section level5">
<h5>Model Residuals</h5>
<p><img src="Analysis-for-Heliconiini-time-learning_files/figure-html/unnamed-chunk-29-1.png" width="672" /></p>
</div>
</div>
</div>
</div>
<div id="hecale-activity-between-time-periods" class="section level2">
<h2>Hecale activity between time periods</h2>
<p>To see whether there was a difference in the total number of choices a butterfly made at a particular time period we used a Poisson generalised linear mixed effect model.</p>
<div id="variables-2" class="section level5">
<h5>Variables</h5>
<ul>
<li><code>total.activity</code> is the total number of choices (correct and incorrect) a butterfly made in a time period</li>
<li><code>time.of.day</code> is the time period of the trial (morning or afternoon)</li>
<li><code>cage</code> is the identity of the cage the individual was tested and trained in</li>
<li><code>id</code> is the identity of the individual butterfly</li>
</ul>
</div>
<div id="model-6" class="section level5">
<h5>Model</h5>
<div class="sourceCode" id="cb11"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb11-1"><a href="hecale-experiments.html#cb11-1" aria-hidden="true" tabindex="-1"></a>activity.model <span class="ot">=</span> </span>
<span id="cb11-2"><a href="hecale-experiments.html#cb11-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">glmer</span>(total.activity <span class="sc">~</span> time.of.day <span class="sc">+</span> (<span class="dv">1</span> <span class="sc">|</span> cage<span class="sc">/</span>id),</span>
<span id="cb11-3"><a href="hecale-experiments.html#cb11-3" aria-hidden="true" tabindex="-1"></a>                       <span class="at">data=</span> data, <span class="at">family =</span> poisson)</span></code></pre></div>
</div>
<div id="results-6" class="section level5">
<h5>Results</h5>
<table>
<thead>
<tr class="header">
<th align="left">term</th>
<th align="right">estimate</th>
<th align="right">std.error</th>
<th align="right">statistic</th>
<th align="left">p.value</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">(Intercept)</td>
<td align="right">4.270</td>
<td align="right">0.102</td>
<td align="right">41.887</td>
<td align="left">&lt; .001</td>
</tr>
<tr class="even">
<td align="left">time.of.day2afternoon</td>
<td align="right">-0.346</td>
<td align="right">0.026</td>
<td align="right">-13.082</td>
<td align="left">&lt; .001</td>
</tr>
</tbody>
</table>
<p>On average butterflies make 24 less choices in the afternoon.</p>
<div class="figure"><span id="fig:activity-data-plot"></span>
<img src="Analysis-for-Heliconiini-time-learning_files/figure-html/activity-data-plot-1.png" alt="The morning and afternoon activity values for individuual btuterflies. Data are means +/- 95% CI. Lines connects individuals across time periods" width="672" />
<p class="caption">
Figure 2: The morning and afternoon activity values for individuual btuterflies. Data are means +/- 95% CI. Lines connects individuals across time periods
</p>
</div>
</div>
<div id="model-residuals-6" class="section level5">
<h5>Model Residuals</h5>
<p><img src="Analysis-for-Heliconiini-time-learning_files/figure-html/unnamed-chunk-33-1.png" width="672" /></p>

</div>
</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="index.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="dryas-experiments.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": false,
"twitter": false,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": null,
"text": null
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": null,
"toc": {
"collapse": "subsection"
}
});
});
</script>

</body>

</html>
